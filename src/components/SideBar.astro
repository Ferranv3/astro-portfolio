---
import { Image } from "astro:assets";
import CalendarIcon from "./icons/CalendarIcon";
import LinkedinIcon from "./icons/LinkedinIcon";
import GithubIcon from "./icons/GithubIcon";

const {
  labels,
  homeHref = "/",
  contactEmail = "ferranhpv3@gmail.com",
} = Astro.props;

const sectionHref = (hash: string) => `${homeHref}${hash}`;
---

<div class="drawer-side bg-base-200">
  <label for="my-drawer" class="drawer-overlay bg-base-200"></label>
  <div
    class="menu drawer-menu flex flex-col items-center flex-nowrap pt-2 overflow-y-auto w-[20rem] max-w-full bg-base-200 text-base-content justify-between h-[100dvh]"
  >
    <div class="sidebar-avatar w-fit min-h-1">
      <a href={homeHref}>
        <div
          class="avatar transition ease-in-out w-1/2 hover:scale-[102%] block m-auto mt-3 mb-6 h-36"
        >
          <div>
            <Image
              class="mask mask-circle"
              format="webp"
              width={300}
              height={300}
              src="/profile.webp"
              alt="Profile image"
              loading="lazy"
              decoding="async"
            />
          </div>
        </div>
      </a>
    </div>
    <ul class="sidebar-links min-h-1 -mt-9">
      <li><a class="menu" id="home" href={homeHref}>{labels.home}</a></li>
      <li><a class="menu" id="projects" href={sectionHref("#projects")}>{labels.projects}</a></li>
      <li><a class="menu" id="experience" href={sectionHref("#experience")}>{labels.experience}</a></li>
      <li><a class="menu" id="education" href={sectionHref("#education")}>{labels.education}</a></li>
      <li><a class="menu" id="languages" href={sectionHref("#languages")}>{labels.languages}</a></li>
      <li><a class="menu" id="certifications" href={sectionHref("#certifications")}>{labels.certifications}</a></li>
      <li><a class="menu" id="skills" href={sectionHref("#skills")}>{labels.skills}</a></li>
      <li><a class="menu" href={`mailto:${contactEmail}`}>{labels.contact}</a></li>
    </ul>
    <div class="social-icons px-4 my-2 flex self-center min-h-3">
      <a
        href="https://github.com/Ferranv3"
        target="_blank"
        class="mx-3"
        aria-label="Github"
        title="Github"
      >
        <GithubIcon />
      </a>
      <a
        href="https://www.linkedin.com/in/ferran-hernandez-v3/"
        target="_blank"
        class="mx-3"
        aria-label="Linkedin"
        title="Linkedin"
      >
        <LinkedinIcon />
      </a>
      <a
        href="https://calendly.com/d/cwgs-txt-yqj/meeting"
        target="_blank"
        class="mx-3"
        aria-label="Calendly"
        title="Calendly"
      >
        <CalendarIcon />
      </a>
    </div>
  </div>
</div>

<script>
  const myDrawer = document.querySelector('#my-drawer');
  const links = document.querySelectorAll('a.menu');

  function toggleMenu() {
    myDrawer.checked = !myDrawer.checked;
  }

  // Maneja los clics en cada botÃ³n.
  links.forEach((button) => {
    button.addEventListener('click', () => {
      toggleMenu();
    });
  });
</script>

<style>
  @media (max-width: 640px) {
    .drawer-side .drawer-menu {
      justify-content: space-between;
      gap: 0;
      padding-top: 0.35rem;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 0.35rem);
    }

    .drawer-side .sidebar-avatar .avatar {
      width: 6.5rem;
      height: 6.5rem;
      margin-top: 0;
      margin-bottom: 0;
    }

    .drawer-side .sidebar-avatar {
      margin-bottom: 0;
    }

    .drawer-side .sidebar-links {
      margin-top: auto;
      margin-bottom: auto;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: clamp(0.08rem, 0.4vh, 0.25rem);
    }

    .drawer-side .menu li a.menu {
      width: 100%;
      padding: 0.6rem 1.5rem;
      font-size: clamp(0.95rem, 3.7vw, 1.05rem);
      line-height: 1.2;
    }

    .drawer-side .social-icons {
      margin-top: 0;
      margin-bottom: 0;
      padding-top: 0;
    }
  }

  .drawer-side .drawer-menu {
    padding-bottom: 1.5rem;
    padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1.5rem);
  }
</style>
