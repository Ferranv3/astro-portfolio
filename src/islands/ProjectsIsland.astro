---
import HorizontalCard from "../components/HorizontalCard.astro";
import SeeMoreButton from "../components/SeeMoreButton.astro";

const { title, featured, extra, seeMoreLabel } = Astro.props;
---
<>
  <div id="projects" class="mb-5">
    <div class="text-3xl w-full font-bold text-center">{title}</div>
  </div>

  <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
    {featured.map((project) => (
      <HorizontalCard {...project} />
    ))}
  </div>
  <div
    id="extra-projects"
    class="hidden grid grid-cols-1 gap-6 lg:grid-cols-2"
    aria-hidden="true"
  >
    {extra.map((project) => (
      <HorizontalCard {...project} />
    ))}
  </div>
  <div class="button-container">
    <SeeMoreButton
      id="toggleButton"
      label={seeMoreLabel}
      ariaExpanded="false"
      ariaControls="extra-projects"
    />
  </div>
  <script is:inline>
    (() => {
      const init = () => {
        const extraProjects = document.getElementById('extra-projects');
        const button = document.getElementById('toggleButton');
        if (!extraProjects || !button) return;
        button.addEventListener(
          'click',
          () => {
            extraProjects.classList.remove('hidden');
            extraProjects.setAttribute('aria-hidden', 'false');
            button.setAttribute('aria-expanded', 'true');
            button.classList.add('hidden');
          },
          { once: true }
        );
      };
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init, { once: true });
      } else {
        init();
      }
    })();
  </script>

  <style>
    .button-container {
      display: flex;
      justify-content: center;
      margin-top: 0.5rem;
      margin-bottom: 1.5rem;
    }
  </style>
</>
